---
title: "AI 사용해보기: ChatGPT와 Llama2 활용하기"
date: 2023-10-04 17:29:12 +0900
categories:
  - blog
tags:
  - AI
  - ChatGPT
  - Llama2

 
---

인공 지능(AI)의 성장과 발전으로, 최근에는 다양한 분야에서 AI를 활용하는 사례가 증가하고 있다. <br>
가장 기본적인 예제로 사용해보려고한다.

다음의 세 가지 케이스에 대해 진행해보려고 한다:

1. ChatGPT Open API를 활용한 자연어 처리
2. Llama2를 통한 고급 자연어 처리 방법
3. Llama2를 사용한 Embedding 기술 실습

### 참조
Llama2에 대한 실습은 [Llama2 Embedding](https://breezymind.com/llamacpp-embedding/)를 참조하였다.

### 실습 환경
- 운영체제: Windows 11
- 개발 언어: Python 3.10.11
- 웹 프레임워크: Flask

## [01] ChatGPT Open API와 프롬프트 엔지니어링
ChatGPT Open API를 통해 사용자의 입력을 받아 처리하고 적절한 답변을 반환하는 예시이다.<bR>
본 예시에서는 친구가 운영하는 카페 메뉴를 추천하는 컨셉으로 구현하였다.

### 프롬프트 엔지니어링이란?
프롬프트 엔지니어링은 사용자의 질문이나 명령을 AI 모델이 이해하고 처리할 수 있는 형태로 변환하는 과정이다.<br>
적절한 프롬프트를 설계함으로써 모델의 출력 결과를 최적화할 수 있다.


```python
from flask import Flask, request, jsonify
import openai
import json

app = Flask(__name__)
api_key = "your_openai_api_key_here"
openai.api_key = api_key

@app.route('/recommend_coffee', methods=['POST'])
def recommend_coffee():
    user_input = request.json.get('user_input')
    with open('user_data.json', 'a') as f:
        json.dump({'user_input': user_input}, f)
        f.write('\n')

    # 입력에 따라 동적으로 프롬프트 설정
    if '추천' in user_input or '메뉴' in user_input:
        prompt = f"User: {user_input}\nAI: 안나커피에서 어떤 메뉴를 추천하겠습니까?"
    elif '위치' in user_input or '어디' in user_input:
        prompt = f"User: {user_input}\nAI: 안나커피의 위치는 어디인가요?"
    else:
        prompt = f"User: {user_input}\nAI: 죄송합니다, 무슨 정보를 원하시나요?"

    response = openai.Completion.create(
        engine="text-davinci-002",
        prompt=prompt,
        max_tokens=50
    )

    coffee_recommendation = response.choices[0].text.strip()
    with open('ai_recommendations.json', 'a') as f:
        json.dump({'coffee_recommendation': coffee_recommendation}, f)
        f.write('\n')

    return jsonify({"recommendation": coffee_recommendation})

if __name__ == "__main__":
    app.run(debug=True)
```


<br>
'추천'이라는 단어가 포함되면 카페 메뉴를 추천하도록 userInput을 보강하고,
'위치'라는 단어가 포함되면 카페의 위치 정보를 제공하게끔 userInput을 보강한다.


## [02] Llama2 사용해보기

### Llama2 모델 다운로드

https://huggingface.co/TheBloke/Llama-2-7b-Chat-GGUF/blob/main/llama-2-7b-chat.Q4_K_M.gguf?ref=breezymind.com

### LlamaCpp 설치하기
https://python.langchain.com/docs/integrations/llms/llamacpp?ref=breezymind.com


GPU가 좋지 않아서 CPU의 토대 버전을 설치하였다.

```pip install llama-cpp-python```

llama-cpp-python이 제대로 설치되지 않을 경우,


1. visual cpp 빌드 도구를 설치- https://visualstudio.microsoft.com/visual-cpp-build-tools/
2. 아래의 명령어를 사용하여 cython을 설치
py -m pip install cython
3. 다음 경로를 PATH 변수에 설정하세요 -
C:\Users\XXXXX\AppData\Local\Programs\Python\Python311\Scripts

제 경우에는 MSVC V143를 설치하면서 문제가 발생했었습니다. MSVC V142를 재설치하니 정상적으로 설치가 완료되었습니다.

```python

```
